{"ts":1354609049417,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"window.addEventListener('load', function() {\n\n  var input = document.querySelector('input[type=text]');\n  var reception = document.querySelector('.reception');\n  var face = document.querySelector('.face');\n  var faceTag = '<embed src=\"/images/faceTag\" width=\"200\", height=\"250\" />';\n  var reg= new RegExp('((https?):\\/\\/[0-9a-zA-Z,;:~&=@_\\'%?+\\-\\/\\$.!*()#]+)','gi');\n  document.querySelector('form').addEventListener('submit', function(e) {\n    \n    var req = new XMLHttpRequest();\n    req.open('POST', '/talk');\n    req.onreadystatechange = function() {\n      if (req.readyState == 4 && req.status == 200) {\n        var ans = JSON.parse(req.responseText)\n        if(ans.glasses=='1'){\n            switch(ans.face){\n                case '0':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"default.swf\");\n                    break;\n                case '1':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"ki.swf\");\n                    break;\n                case '2':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"ai.swf\");\n                    break;\n                case '3':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"kyou.swf\");\n                    break;\n                case '4':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"do.swf\");\n                    break;\n                default:\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"default.swf\");\n                    break;\n           }\n       } else {\n            switch(ans.face){\n                case '0':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"default_g.swf\");\n                    break;\n                case '1':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"ki_g.swf\");\n                    break;\n                case '2':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"ai_g.swf\");\n                    break;\n                case '3':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"kyou_g.swf\");\n                    break;\n                case '4':\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"do_g.swf\");\n                    break;\n                default:\n                    face.innerHTML = faceTag.replace(\"faceTag\",\"default_g.swf\");\n                    break;\n            }\n        }\n        var answer = ans.answer.replace(reg,'<a href=' + \"$1\"+ ' target=\"_blank\">こちらよりご確認ください</a>');\n        reception.innerHTML= answer;\n        input.value = '';\n      }\n    };\n    \n    req.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    req.send('input=' + encodeURIComponent(input.value));\n    e.preventDefault();\n  }, false);\n  \n  input.focus();\n\n}, false);"]],"start1":0,"start2":0,"length1":0,"length2":2746}]],"length":2746}
{"ts":1354609105045,"patch":[[{"diffs":[[0,"nseText)"],[1,";"],[0,"\n       "]],"start1":647,"start2":647,"length1":16,"length2":17}]],"length":2747,"saved":false}
